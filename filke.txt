This is from master bvach
Added chart function in our branch